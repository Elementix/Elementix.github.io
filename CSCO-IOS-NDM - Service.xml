<?xml version="1.0" encoding="utf-16"?>
<PolicyReport xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <ID>623fb278-6873-4554-b73d-2a72f166a59d</ID>
  <Name>CSCO-IOS-NDM - Service</Name>
  <Comments>Cisco IOS Router NDM Security Technical Implementation Guide: Version: 1: Release: 2:  24 Jan 2020</Comments>
  <Group>Cisco-IOS-NDM-V1R1</Group>
  <ShowSummaryFlag>false</ShowSummaryFlag>
  <ShowRulesWithoutViolationFlag>true</ShowRulesWithoutViolationFlag>
  <AssignedPolicies>
    <Policy>
      <NodeSelectionString>WebCriteria:&lt;?xml version="1.0" encoding="utf-16"?&gt;
&lt;ArrayOfWebSelectionCriteria xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
  &lt;WebSelectionCriteria&gt;
    &lt;Id&gt;698fef1b-d95e-4aa5-bd4d-5db7e00b831c&lt;/Id&gt;
    &lt;LogicalCondition /&gt;
    &lt;SelectedColumn&gt;Vendor&lt;/SelectedColumn&gt;
    &lt;MatchType&gt;=&lt;/MatchType&gt;
    &lt;SelectedValue&gt;Cisco&lt;/SelectedValue&gt;
  &lt;/WebSelectionCriteria&gt;
&lt;/ArrayOfWebSelectionCriteria&gt;SQL:Where (Vendor = 'Cisco') </NodeSelectionString>
      <ConfigTypes>Running</ConfigTypes>
      <AssignedPolicyRules>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>e667d461-996b-4470-8a3f-029d024b94b6</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-001470 - Service</RuleName>
          <Comments>The Cisco router must be running an IOS release that is currently supported by Cisco Systems.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
Verify that the router is in compliance with this requirement by having the router administrator enter the following command: 

show version

Verify that the release is still supported by Cisco. All releases supported by Cisco can be found on the following URL:

www.cisco.com/c/en/us/support/ios-nx-os-software

If the router is not running a supported release, this is a finding.

Fix Text: Upgrade the router to a supported release.  

CCI: CCI-000366
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>2</ErrorLevel>
          <SimplePatternText>Manual Inspection of IOS</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>class-map match-all CoPP_CRITICAL</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>match access-group name CoPP_CRITICAL</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>class-map match-any CoPP_IMPORTANT</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>match access-group name CoPP_IMPORTANT</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>class-map match-all CoPP_NORMAL</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>match access-group name CoPP_NORMAL</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>class-map match-any CoPP_UNDESIRABLE</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>match access-group name CoPP_UNDESIRABLE</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>class-map match-all CoPP_DEFAULT</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>match access-group name CoPP_DEFAULT</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>42dc3334-eea6-4677-b260-254c24da26ee</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-001220 - Service</RuleName>
          <Comments>The Cisco router must be configured to protect against known types of denial-of-service (DoS) attacks by employing organization-defined security safeguards.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
Review the Cisco router configuration to verify that it is compliant with this requirement. 

Step 1: Verify traffic types have been classified based on importance levels. The following is an example configuration: 

class-map match-all CoPP_CRITICAL 
match access-group name CoPP_CRITICAL 
class-map match-any CoPP_IMPORTANT 
match access-group name CoPP_IMPORTANT 
match protocol arp 
class-map match-all CoPP_NORMAL 
match access-group name CoPP_NORMAL 
class-map match-any CoPP_UNDESIRABLE 
match access-group name CoPP_UNDESIRABLE 
class-map match-all CoPP_DEFAULT 
match access-group name CoPP_DEFAULT 

Step 2: Review the ACLs referenced by the class maps to determine if the traffic is being classified appropriately. The following is an example configuration: 

ip access-list extended CoPP_CRITICAL 
remark our control plane adjacencies are critical 
permit ospf host [OSPF neighbor A] any 
permit ospf host [OSPF neighbor B] any 
permit pim host [PIM neighbor A] any 
permit pim host [PIM neighbor B] any 
permit pim host [RP addr] any 
permit igmp any 224.0.0.0 15.255.255.255 
permit tcp host [BGP neighbor] eq bgp host [local BGP addr] 
permit tcp host [BGP neighbor] host [local BGP addr] eq bgp 
deny ip any any 

ip access-list extended CoPP_IMPORTANT 
permit tcp host [TACACS server] eq tacacs any 
permit tcp [management subnet] 0.0.0.255 any eq 22 
permit udp host [SNMP manager] any eq snmp 
permit udp host [NTP server] eq ntp any 
deny ip any any 

ip access-list extended CoPP_NORMAL 
remark we will want to rate limit ICMP traffic 
permit icmp any any echo 
permit icmp any any echo-reply 
permit icmp any any time-exceeded 
permit icmp any any unreachable 
deny ip any any 

ip access-list extended CoPP_UNDESIRABLE 
remark other management plane traffic that should not be received 
permit udp any any eq ntp 
permit udp any any eq snmp
permit tcp any any eq 22 
permit tcp any any eq 23 
remark other control plane traffic not configured on router 
permit eigrp any any 
permit udp any any eq rip 
deny ip any any 

ip access-list extended CoPP_DEFAULT 
permit ip any any 

Note: Explicitly defining undesirable traffic with ACL entries enables the network operator to collect statistics. Excessive ARP packets can potentially monopolize Route Processor resources, starving other important processes. Currently, ARP is the only Layer 2 protocol that can be specifically classified using the match protocol command. 

Step 3: Review the policy-map to determine if the traffic is being policed appropriately for each classification. The following is an example configuration: 

policy-map CONTROL_PLANE_POLICY 
class CoPP_CRITICAL 
police 512000 8000 conform-action transmit exceed-action transmit 
class CoPP_IMPORTANT 
police 256000 4000 conform-action transmit exceed-action drop 
class CoPP_NORMAL 
police 128000 2000 conform-action transmit exceed-action drop 
class CoPP_UNDESIRABLE 
police 8000 1000 conform-action drop exceed-action drop 
class CoPP_DEFAULT
police 64000 1000 conform-action transmit exceed-action drop 

Step 4: Verify that the CoPP policy is enabled. The following is an example configuration: 

control-plane 
service-policy input CONTROL_PLANE_POLICY 

Note: Control Plane Protection (CPPr) can be used to filter as well as police control plane traffic destined to the RP. CPPr is very similar to CoPP and has the ability to filter and police traffic using finer granularity by dividing the aggregate control plane into three separate categories: (1) host, (2) transit, and (3) CEF-exception. Hence, a separate policy-map could be configured for each traffic category.

If the Cisco router is not configured to protect against known types of DoS attacks by employing organization-defined security safeguards, this is a finding.

Fix Text: Configure the Cisco router to protect against known types of DoS attacks on the route processor. Implementing a CoPP policy as shown in the example below is a best practice method.

Step 1: Configure ACLs specific traffic types.

R1(config)#ip access-list extended CoPP_CRITICAL
R1(config-ext-nacl)#remark our control plane adjacencies are critical
R1(config-ext-nacl)#permit ospf host x.x.x.x any
R1(config-ext-nacl)#permit ospf host x.x.x.x any
R1(config-ext-nacl)#permit pim host x.x.x.x any
R1(config-ext-nacl)#permit pim host x.x.x.x any
R1(config-ext-nacl)#permit igmp any 224.0.0.0 15.255.255.255
R1(config-ext-nacl)#permit tcp host x.x.x.x eq bgp host x.x.x.x
R1(config-ext-nacl)#deny ip any any
R1(config-ext-nacl)#exit

R1(config)#ip access-list extended CoPP_IMPORTANT
R1(config-ext-nacl)#permit tcp host x.x.x.x eq tacacs any
R1(config-ext-nacl)#permit tcp x.x.x.x 0.0.0.255 any eq 22
R1(config-ext-nacl)#permit udp host x.x.x.x any eq snmp
R1(config-ext-nacl)#permit udp host x.x.x.x eq ntp any
R1(config-ext-nacl)#deny ip any any
R1(config-ext-nacl)#exit

R1(config)#ip access-list extended CoPP_NORMAL
R1(config-ext-nacl)#remark we will want to rate limit ICMP traffic
R1(config-ext-nacl)#permit icmp any any echo
R1(config-ext-nacl)#permit icmp any any echo-reply
R1(config-ext-nacl)#permit icmp any any time-exceeded
R1(config-ext-nacl)#permit icmp any any unreachable
R1(config-ext-nacl)#deny ip any any
R1(config-ext-nacl)#exit

R1(config)#ip access-list extended CoPP_UNDESIRABLE
R1(config-ext-nacl)#remark management plane traffic that should not be received
R1(config-ext-nacl)#permit udp any any eq ntp
R1(config-ext-nacl)#permit udp any any eq snmp
R1(config-ext-nacl)#permit tcp any any eq 22
R1(config-ext-nacl)#permit tcp any any eq 23
R1(config-ext-nacl)#remark control plane traffic not configured on router
R1(config-ext-nacl)#permit eigrp any any
R1(config-ext-nacl)#permit udp any any eq rip
R1(config-ext-nacl)#deny ip any any
R1(config-ext-nacl)#exit
R1(config)#ip access-list extended CoPP_DEFAULT
R1(config-ext-nacl)#permit ip any any
R1(config-ext-nacl)#exit

Step 2: Configure class maps referencing each of the ACLs.

R1(config)#class-map match-all CoPP_CRITICAL
R1(config-cmap)#match access-group name CoPP_CRITICAL
R1(config-cmap)#class-map match-any CoPP_IMPORTANT
R1(config-cmap)#match access-group name CoPP_IMPORTANT
R1(config-cmap)#match protocol arp
R1(config-cmap)#class-map match-all CoPP_NORMAL
R1(config-cmap)#match access-group name CoPP_NORMAL
R1(config-cmap)#class-map match-any CoPP_UNDESIRABLE
R1(config-cmap)#match access-group name CoPP_UNDESIRABLE
R1(config-cmap)#class-map match-all CoPP_DEFAULT
R1(config-cmap)#match access-group name CoPP_DEFAULT
R1(config-cmap)#exit

Step 3: Configure a policy map referencing the configured class maps and apply appropriate bandwidth allowance and policing attributes.

R1(config)#policy-map CONTROL_PLANE_POLICY
R1(config-pmap)#class CoPP_CRITICAL
R1(config-pmap-c)#police 512000 8000 conform-action transmit exceed-action transmit
R1(config-pmap-c-police)#class CoPP_IMPORTANT
R1(config-pmap-c)#police 256000 4000 conform-action transmit exceed-action drop
R1(config-pmap-c-police)#class CoPP_NORMAL
R1(config-pmap-c)#police 128000 2000 conform-action transmit exceed-action drop
R1(config-pmap-c-police)#class CoPP_UNDESIRABLE
R1(config-pmap-c)#police 8000 1000 conform-action drop exceed-action drop
R1(config-pmap-c-police)#class CoPP_DEFAULT
R1(config-pmap-c)#police 64000 1000 conform-action transmit exceed-action drop
R1(config-pmap-c-police)#exit
R1(config-pmap-c)#exit
R1(config-pmap)#exit

Step 4: Apply the policy map to the control plane.

R1(config)#control-plane
R1(config-cp)#service-policy input CONTROL_PLANE_POLICY
R1(config-cp)#end  

CCI: CCI-002385
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>By using this IS (which includes any device attached to this IS), you consent to the following conditions:</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>-At any time, the USG may inspect and seize data stored on this IS.
</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>a61dc7be-3f1e-4b86-a0e8-3518922278ac</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-000160 - Services</RuleName>
          <Comments>The Cisco router must be configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device.
</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
Review the Cisco router configuration to verify that it is compliant with this requirement as shown in the example below.

banner login ^C
You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.
^C

If the Cisco router is not configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device, this is a finding.

Fix Text: Configure the Cisco router to display the Standard Mandatory DoD Notice and Consent Banner before granting access as shown in the following example:

R1(config)#banner login #
Enter TEXT message. End with the character '#'.
You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details. #
R1(config)#end  

CCI: CCI-000048
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>ip access-list extended BLOCK_INBOUND</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>deny icmp any any log-input</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>b5ed5b6e-fe1a-4330-8381-40691f153f88</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-000290 - ACL</RuleName>
          <Comments>The Cisco router must produce audit records containing information to establish where the events occurred.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
Review the deny statements in all ACLs to determine if the log-input parameter has been configured as shown in the example below.

ip access-list extended BLOCK_INBOUND
 deny icmp any any log-input

If the router is not configured with the log-input parameter after any deny statements to note where packets have been dropped via an ACL, this is a finding.

Fix Text: Configure the log-input parameter after any deny statements to provide the location as to where packets have been dropped via an ACL.

R1(config)#ip access-list extended BLOCK_INBOUND
R1(config-ext-nacl)#deny icmp any any log-input  

CCI: CCI-000132
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>a69d5b5c-b6d9-44a9-a505-5747736a2bed</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-000620 - Service</RuleName>
          <Comments>The Cisco router must only store cryptographic representations of passwords.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
Review the router configuration to determine if passwords are encrypted as shown in the example below.

service password-encryption

If the router is not configured to encrypt passwords, this is a finding.

Fix Text: Configure the router to encrypt all passwords.

R4(config)#service password-encryption 
R4(config)#end  

CCI: CCI-000196
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>2</ErrorLevel>
          <SimplePatternText>service password-encryption</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>ip http authentication aaa login-authentication LOGIN_AUTHENTICATION</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>exec-timeout 10 0</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>a2f6f54b-5fb2-4091-9eab-8c78533d5f60</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-000900 - Service</RuleName>
          <Comments>The Cisco router must be configured to be compliant with at least one IETF Internet standard authentication protocol.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
Review the Cisco router configuration to verify that the device is configured to use an authentication server as primary source for authentication as shown in the following example:

aaa new-model
!
aaa authentication login LOGIN_AUTHENTICATION group radius local
…
…
…
ip http authentication aaa login-authentication LOGIN_AUTHENTICATION
ip http secure-server
…
…
…
radius-server host x.x.x.x auth-port 1645 acct-port 1646 key xxxxxxx
…
…
…
line con 0
 exec-timeout 10 0
 login authentication LOGIN_AUTHENTICATION
line vty 0 4
 exec-timeout 10 0
 login authentication LOGIN_AUTHENTICATION

If the Cisco router is not configured to use an authentication server as primary source for authentication, this is a finding.

Fix Text: Step 1: Configure the router to use an authentication server as shown in the following example:

R4(config)#radius host x.x.x.x key xxxxxx

Step 2: Configure the authentication order to use the authentication server as primary source for authentication as shown in the following example:

R4(config)#aaa authentication login LOGIN_AUTHENTICATION group radius local

Step 3: Configure all network connections associated with a device management to use an authentication server for the purpose of login authentication as shown in the following example:

R4(config)#line vty 0 4
R4(config-line)#login authentication LOGIN_AUTHENTICATION
R4(config-line)#exit
R4(config)#line con 0
R4(config-line)#login authentication LOGIN_AUTHENTICATION
R4(config-line)#exit 
R4(config)#ip http authentication aaa login-authentication LOGIN_AUTHENTICATION  

CCI: CCI-000366


CCI: CCI-002353
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>The Cisco router must be configured to be compliant with at least one IETF Internet standard authentication protocol.</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>72c89609-9bc2-4d22-94b8-902d33df8b36</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-000720 - Service</RuleName>
          <Comments>The Cisco router must be configured to terminate all network connections associated with device management after 10 minutes of inactivity.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
Review the Cisco router configuration to verify that all network connections associated with a device management have an idle timeout value set to 10 minutes or less as shown in the following example:

ip http secure-server
ip http timeout-policy idle 600 life nnnn requests nn
…
…
…
line con 0
 exec-timeout 10 0
line vty 0 4
 exec-timeout 10 0

If the Cisco router is not configured to terminate all network connections associated with a device management after "10" minutes of inactivity, this is a finding.

Fix Text: Set the idle timeout value to "10" minutes or less on all configured login classes as shown in the example below.

R1(config)#line vty 0 4
R1(config-line)#exec-timeout 10 0
R1(config-line)#exit
R1(config)#line con 0
R1(config-line)#exec-timeout 10 0
R1(config-line)#exit
R2(config)#ip http timeout-policy idle 600 life nnnn requests nn  

CCI: CCI-001133
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>2</ErrorLevel>
          <SimplePatternText>ip http timeout-policy idle 600 life nnnn requests nn</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>feef4b0e-8747-4e40-ae17-926249ae41ac</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-001100 - Service</RuleName>
          <Comments>The Cisco router must require users to reauthenticate when privilege escalation or role changes occur.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
The Cisco router is not compliant with this requirement. However, the risk associated with this requirement can be fully mitigated if the router is configured to utilize an authentication server to authenticate and authorize users for administrative access.

Review the router configuration to verify that the device is configured to use an authentication server as primary source for authentication as shown in the following example:

aaa new-model
!
aaa authentication login LOGIN_AUTHENTICATION group radius local
…
…
…
ip http authentication aaa login-authentication LOGIN_AUTHENTICATION
ip http secure-server
…
…
…
radius-server host x.x.x.x auth-port 1645 acct-port 1646 key xxxxxxx
…
…
…
line con 0
 exec-timeout 10 0
 login authentication LOGIN_AUTHENTICATION
line vty 0 4
 exec-timeout 10 0
 login authentication LOGIN_AUTHENTICATION

If the router is not configured to use an authentication server to authenticate and authorize users for administrative access, this is a finding.

Fix Text: Step 1: Configure the Cisco router to use an authentication server as shown in the following example:

R4(config)#radius host 10.1.48.2 key xxxxxx

Step 2: Configure the authentication order to use the authentication server as primary source for authentication as shown in the following example:

R4(config)#aaa authentication login LOGIN_AUTHENTICATION group radius local

Step 3: Configure all network connections associated with a device management to use an authentication server for the purpose of login authentication.

R4(config)#line vty 0 4
R4(config-line)#login authentication LOGIN_AUTHENTICATION
R4(config-line)#exit
R4(config)#line con 0
R4(config-line)#login authentication LOGIN_AUTHENTICATION
R4(config-line)#exit 
R4(config)#ip http authentication aaa login-authentication LOGIN_AUTHENTICATION  

CCI: CCI-002038
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>ip http authentication aaa login-authentication LOGIN_AUTHENTICATION</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>no boot network</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>no ip boot server</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>no ip bootp server</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>no ip dns server</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>no ip identd</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>no ip finger</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>no ip http server</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>no ip rcmd rcp-enable</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>no ip rcmd rsh-enable</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition>AND</Condition>
              <Pattern>no service config</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition>AND</Condition>
              <Pattern>no service finger</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition>AND</Condition>
              <Pattern>no service tcp-small-servers</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition>AND</Condition>
              <Pattern>no service udp-small-servers</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition>AND</Condition>
              <Pattern>no service pad</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>d3c7766c-eb93-431c-a853-baf0d9b08a77</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-000470 - Service</RuleName>
          <Comments>The Cisco router must be configured to prohibit the use of all unnecessary and nonsecure functions and services.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
Verify that the router does not have any unnecessary or non-secure ports, protocols and services enabled. For example, the following commands should not be in the configuration:

boot network
ip boot server
ip bootp server
ip dns server
ip identd
ip finger
ip http server
ip rcmd rcp-enable
ip rcmd rsh-enable
service config
service finger
service tcp-small-servers
service udp-small-servers

If any unnecessary or non-secure ports, protocols, or services are enabled, this is a finding.

Fix Text: Disable the following services if enabled as shown in the example below.

R2(config)#no boot network
R2(config)#no ip boot server
R2(config)#no ip bootp server
R2(config)#no ip dns server
R2(config)#no ip identd
R2(config)#no ip finger
R2(config)#no ip http server
R2(config)#no ip rcmd rcp-enable
R2(config)#no ip rcmd rsh-enable
R2(config)#no service config
R2(config)#no service finger
R2(config)#no service tcp-small-servers
R2(config)#no service udp-small-servers
R2(config)#no service pad
R2(config)#end  

CCI: CCI-000382
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>2</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>ip http authentication aaa login-authentication LOGIN_AUTHENTICATION</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>ip http secure-server</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>799eb3ff-3df0-4276-8dea-d71ac63ef538</RuleId>
          <RuleName>CSCO-IOS-NDM-CISC-ND-000810 - Service</RuleName>
          <Comments>The Cisco router must generate alerts that can be forwarded to the administrators and ISSO when accounts are modified.</Comments>
          <Grouping>CSCO-IOS-NDM</Grouping>
          <RemediateScript>Check Content:  
The Cisco router is not compliant with this requirement. However, the risk associated with this requirement can be fully mitigated if the router is configured to utilize an authentication server to authenticate and authorize users for administrative access.

Review the router configuration to verify that the device is configured to use an authentication server as primary source for authentication as shown in the following example:

aaa new-model
!
aaa authentication login LOGIN_AUTHENTICATION group radius local
…
…
…
ip http authentication aaa login-authentication LOGIN_AUTHENTICATION
ip http secure-server
…
…
…
radius-server host x.x.x.x auth-port 1645 acct-port 1646 key xxxxxxx
…
…
…
line con 0
 exec-timeout 10 0
 login authentication LOGIN_AUTHENTICATION
line vty 0 4
 exec-timeout 10 0
 login authentication LOGIN_AUTHENTICATION

If the router is not configured to use an authentication server to authenticate and authorize users for administrative access, this is a finding.

Fix Text: Step 1: Configure the Cisco router to use an authentication server as shown in the following example:

R4(config)#radius host 10.1.48.2 key xxxxxx

Step 2: Configure the authentication order to use the authentication server as primary source for authentication as shown in the following example:

R4(config)#aaa authentication login LOGIN_AUTHENTICATION group radius local

Step 3: Configure all network connections associated with a device management to use an authentication server for the purpose of login authentication.

R4(config)#line vty 0 4
R4(config-line)#login authentication LOGIN_AUTHENTICATION
R4(config-line)#exit
R4(config)#line con 0
R4(config-line)#login authentication LOGIN_AUTHENTICATION
R4(config-line)#exit 
R4(config)#ip http authentication aaa login-authentication LOGIN_AUTHENTICATION  

CCI: CCI-001684
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
      </AssignedPolicyRules>
      <Grouping>CSCO-IOS-NDM</Grouping>
      <Comments />
      <PolicyName>CSCO-IOS-NDM - Service</PolicyName>
    </Policy>
  </AssignedPolicies>
  <ReportStatus>Enabled</ReportStatus>
</PolicyReport>