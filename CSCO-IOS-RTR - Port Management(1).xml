<?xml version="1.0" encoding="utf-16"?>
<PolicyReport xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <ID>12e00cd1-bcb4-40c4-ba20-eaa473851242</ID>
  <Name>CSCO-IOS-RTR - Port Management</Name>
  <Comments>Cisco IOS Router RTR Security Technical Implementation Guide: Version: 1: Release: 2: 24 JAN 2020</Comments>
  <Group>Cisco-IOS-RTR-V1R1</Group>
  <ShowSummaryFlag>false</ShowSummaryFlag>
  <ShowRulesWithoutViolationFlag>true</ShowRulesWithoutViolationFlag>
  <AssignedPolicies>
    <Policy>
      <NodeSelectionString>WebCriteria:&lt;?xml version="1.0" encoding="utf-16"?&gt;
&lt;ArrayOfWebSelectionCriteria xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
  &lt;WebSelectionCriteria&gt;
    &lt;Id&gt;7bffb67b-9cdb-4a16-8939-32b0da8fa849&lt;/Id&gt;
    &lt;LogicalCondition /&gt;
    &lt;SelectedColumn&gt;Vendor&lt;/SelectedColumn&gt;
    &lt;MatchType&gt;=&lt;/MatchType&gt;
    &lt;SelectedValue&gt;Cisco&lt;/SelectedValue&gt;
  &lt;/WebSelectionCriteria&gt;
&lt;/ArrayOfWebSelectionCriteria&gt;SQL:Where (Vendor = 'Cisco') </NodeSelectionString>
      <ConfigTypes>Running</ConfigTypes>
      <AssignedPolicyRules>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>no ip redirects</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>869999be-d977-490b-885e-15c9811e76b0</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000190 - Port Management</RuleName>
          <Comments>The Cisco router must be configured to have Internet Control Message Protocol (ICMP) redirect messages disabled on all external interfaces.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the router configuration to verify that the no ip redirects command has been configured on all external interfaces as shown in the example below.

interface GigabitEthernet0/1
 ip address x.x.x.x 255.255.255.0
 no ip redirects

If ICMP Redirect messages are enabled on any external interfaces, this is a finding.

Fix Text: Disable ICMP redirects on all external interfaces as shown in the example below.

R4(config)#int g0/1
R4(config-if)#no ip redirects  

CCI: CCI-002385
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart>^interface (TenGigabit|Gigabit|Fast|)Ethernet[\/0-9]+\r</ConfigBlockStart>
          <ConfigBlockEnd>!</ConfigBlockEnd>
          <ConfigBlockPatternType>Regex</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>no exec</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>79fd4e48-2078-418b-a48f-27a490682b6e</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000230 - VTY and Console</RuleName>
          <Comments>The Cisco router must be configured to disable the auxiliary port unless it is connected to a secured modem providing encryption and authentication.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the configuration and verify that the auxiliary port is disabled unless a secured modem providing encryption and authentication is connected to it.

line aux 0
 no exec

Note: transport input none is the default, hence it will not be shown in the configuration.

If the auxiliary port is not disabled or is not connected to a secured modem when it is enabled, this is a finding.

Fix Text: Disable the auxiliary port.

R2(config)#line aux 0
R2(config-line)#no exec 
R2(config-line)#transport input none  

CCI: CCI-001414
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart>line con 0</ConfigBlockStart>
          <ConfigBlockEnd>!</ConfigBlockEnd>
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>6fbce04b-d751-4086-931b-2ec7a16c664b</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000590 - Port Management</RuleName>
          <Comments>The Cisco MPLS router must be configured to use its loopback address as the source address for LDP peering sessions.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the router configuration to determine if it is compliant with this requirement.

Verify that a loopback address has been configured as shown in the following example:

interface Loopback0
 ip address 10.1.1.1 255.255.255.255

By default, routers will use its loopback address for LDP peering. If an address has not be configured on the loopback interface, it will use its physical interface connecting to the LDP peer. If the router-id command is specified that overrides this default behavior, verify that it is a loopback interface as shown in the example below.

mpls ldp router-id Loopback0

If the router is not configured do use its loopback address for LDP peering, this is a finding.

Fix Text: Configure the router to use their loopback address as the source address for LDP peering sessions. As noted in the check content, the default behavior is to use its loopback address. 

R4(config)#mpls ldp router-id lo0  

CCI: CCI-000366
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText>mpls ldp router-id Loopback0</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>491b34a6-a3cb-4359-8ceb-32fb3ca88f2c</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000330 - Port Management</RuleName>
          <Comments>The Cisco perimeter router must be configured to filter ingress traffic at the external interface on an inbound direction.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
This requirement is not applicable for the DODIN Backbone.

Review the router configuration to verify that an inbound ACL is configured on all external interfaces as shown in the example below.

interface GigabitEthernet0/2
 ip address x.11.1.2 255.255.255.254
 ip access-group EXTERNAL_ACL_INBOUND in

If the router is not configured to filter traffic entering the network at all external interfaces in an inbound direction, this is a finding.

Fix Text: This requirement is not applicable for the DODIN Backbone.

Configure the router to use an inbound ACL on all external interfaces as shown in the example below.

R1(config)#int g0/2
R1(config-if)#ip access-group EXTERNAL_ACL_INBOUND in  

CCI: CCI-001097
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>ip access-group EXTERNAL_ACL_INBOUND in  </SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>description INACTIVE LAYER 3 PORT</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>shutdown</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>92dbe054-9819-4ec6-b338-699f90ef88ab</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000060 - Port Management</RuleName>
          <Comments>The Cisco router must be configured to have all inactive interfaces disabled.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the router configuration and verify that inactive interfaces have been disabled as shown below.

interface GigabitEthernet3
 shutdown
!
interface GigabitEthernet4
 shutdown

If an interface is not being used but is configured or enabled, this is a finding.

Fix Text: Disable all inactive interfaces as shown below.

R4(config)#interface GigabitEthernet3
R4(config-if)#shutdown
R4(config)#interface GigabitEthernet4
R4(config-if)#shutdown  

CCI: CCI-001414
_____________________________________________________________


Always provide a description of unused and inactive ports can be identified quicker for violations.</RemediateScript>
          <ConfigBlockStart>^interface (TenGigabit|Gigabit|Fast|)Ethernet[\/0-9]+\r </ConfigBlockStart>
          <ConfigBlockEnd>!</ConfigBlockEnd>
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>crypto map IPSEC_MGMT_MAP 10 ipsec-isakmp</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>set peer x.1.12.1</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>set transform-set TRANS_SET</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>match address MGMT_TRAFFIC_ACL</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>2ebc6405-6bc4-4030-87b5-69d5f556a5a2</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000460 - Tunneling</RuleName>
          <Comments>The Cisco router providing connectivity to the Network Operations Center (NOC) must be configured to forward all in-band management traffic via an IPsec tunnel.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
This requirement is not applicable for the DODIN Backbone.

Verify that all traffic from the managed network to the management network or NOC and vice-versa is secured via IPsec tunnel.

Step 1: Note the crypto map applied to the external interface.

 interface GigabitEthernet0/2
 description link to DISN
 ip address x.1.24.4 255.255.255.0
 crypto map IPSEC_MGMT_MAP

Step 2: Review the ISAKMP policy for Phase 1 negotiations and Phase 2 policy for data encryption.

crypto isakmp policy 10
 authentication pre-share
 hash sha256
 crypto isakmp key xxxxxx address x.1.12.1
!
!
crypto ipsec transform-set TRANS_SET ah-sha256-hmac esp-aes 

Step 3: Review the crypto map that was bound to the external interface and note the ACL defined that identifies the interesting traffic for the IPsec tunnel.

crypto map IPSEC_MGMT_MAP 10 ipsec-isakmp
 set peer x.1.12.1
 set transform-set TRANS_SET
 match address MGMT_TRAFFIC_ACL

Step 4: Review the ACL defined in the crypto map and verify that the destination is the management network.

ip access-list extended MGMT_TRAFFIC_ACL
 permit ip 10.1.34.0 0.0.0.255 10.22.2.0 0.0.0.255

Note: The management network is this example is 10.22.2.0/24

If the management traffic is not secured via IPsec tunnel, this is a finding.

Fix Text: This requirement is not applicable for the DODIN Backbone.

Ensure that all traffic from the managed network to the management network is secured via IPsec tunnel as shown in the configuration examples below.

Step 1: Configure the ACL for the management network as the destination. This ACL will be defined in the crypto as the interesting traffic to be forwarded into the IPsec tunnel.

R4(config)#ip access-list extended MGMT_TRAFFIC_ACL
R4(config-ext-nacl)#permit ip 10.1.34.0 0.0.0.255 10.22.2.0 0.0.0.255
R4(config-ext-nacl)#exit

Step 2: Create an ISAKMP policy for Phase 1 negotiations

R4(config)#crypto isakmp policy 10
R4(config-isakmp)#hash sha256
R4(config-isakmp)#authentication pre-share
R4(config-isakmp)#exit

Step 3: Specify the pre-shared key and the remote peer address

R4(config)#crypto isakmp key 0 xxxxxx address 10.1.12.1

Note: Digital certificates can be utilized as an alternative.

Step 4: Create the Phase 2 policy for the data encryption

R4(config)#crypto ipsec transform-set TRANS_SET ah-sha256-hmac esp-aes
R4(cfg-crypto-trans)#mode tunnel
R4(cfg-crypto-trans)#exit

Step 5: Create the crypto map

R4(config)#crypto map IPSEC_MGMT_MAP 10 ipsec-isakmp
R4(config-crypto-map)#set peer 10.1.12.1
R4(config-crypto-map)#match address MGMT_TRAFFIC_ACL
R4(config-crypto-map)#set transform-set TRANS_SET
R4(config-crypto-map)#end

Step 6: Apply the crypto map to the external interface 
R4(config)#int g0/2
R4(config-if)#crypto map IPSEC_MGMT_MAP  

CCI: CCI-001097
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>ip directed-broadcast</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>682f2a5e-dc1b-4d0f-940a-6e1987bb0d4e</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000160 - Port Management</RuleName>
          <Comments>The Cisco router must be configured to have IP directed broadcast disabled on all interfaces.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the router configuration to determine if it is compliant with this requirement. IP directed broadcast command must not be found on any interface as shown in the example below.

interface GigabitEthernet0/1
 ip address x.x.x.x 255.255.255.0
 ip directed-broadcast

If IP directed broadcast is not disabled on all interfaces, this is a finding.

Fix Text: Disable IP directed broadcast on all interfaces as shown in the example below.

R4(config)#int g0/1
R4(config-if)#no ip directed-broadcast  

CCI: CCI-002385
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart>^interface (TenGigabit|Gigabit|Fast|)Ethernet[\/0-9]+\r</ConfigBlockStart>
          <ConfigBlockEnd>!</ConfigBlockEnd>
          <ConfigBlockPatternType>Regex</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>no ip proxy-arp  </Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>1a43751b-8a6a-4458-b7fc-757930b8e184</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000380 - Port Management</RuleName>
          <Comments>The Cisco perimeter router must be configured to have Proxy ARP disabled on all external interfaces.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
This requirement is not applicable for the DODIN Backbone.

Review the router configuration to determine if IP Proxy ARP is disabled on all external interfaces as shown in the example below.

interface GigabitEthernet0/1
 description link to DISN
 ip address x.1.12.2 255.255.255.252
 no ip proxy-arp

Note: By default Proxy ARP is enabled on all interfaces; hence, if enabled, it will not be shown in the configuration. 

If IP Proxy ARP is enabled on any external interface, this is a finding.

Fix Text: This requirement is not applicable for the DODIN Backbone.

Disable Proxy ARP on all external interfaces as shown in the example below.

R2(config)#int g0/1 
R2(config-if)#no ip proxy-arp  

CCI: CCI-002403
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart>^interface (TenGigabit|Gigabit|Fast|)Ethernet[\/0-9]+\r</ConfigBlockStart>
          <ConfigBlockEnd>!</ConfigBlockEnd>
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>crypto isakmp policy 10</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>authentication pre-share</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>hash sha256</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>crypto isakmp key xxxxxx address x.1.12.1</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>1e4b48f8-4be8-40ee-9791-77a4448d064a</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000400 - Tunneling</RuleName>
          <Comments>The Cisco out-of-band management (OOBM) gateway router must be configured to transport management traffic to the Network Operations Center (NOC) via dedicated circuit, MPLS/VPN service, or IPsec tunnel.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
This requirement is not applicable for the DODIN Backbone.

Review the network topology diagram to determine connectivity between the managed network and the NOC. Review the OOBM gateway router configuration to validate the path and interface that the management traffic traverses. If an IPsec tunnel is used to transport the management traffic between the NOC and the managed network, review the configuration following the steps below.

Step 1: Note the crypto map applied to the external interface

 interface interface GigabitEthernet0/2
 description link to DISN
 ip address x.1.24.4 255.255.255.0
 crypto map IPSEC_MGMT_MAP

Step 2: Review the ISAKMP policy for Phase 1 negotiations and Phase 2 policy for data encryption
crypto isakmp policy 10
 authentication pre-share
 hash sha256
 crypto isakmp key xxxxxx address x.1.12.1
!
!
crypto IPsec transform-set TRANS_SET ah-sha256-hmac esp-aes 

Step 3: Review the crypto map that was bound to the external interface and note the ACL defined that identifies the interesting traffic for the IPsec tunnel.

crypto map IPSEC_MGMT_MAP 10 ipsec-isakmp
 set peer x.1.12.1
 set transform-set TRANS_SET
 match address MGMT_TRAFFIC_ACL

Step 4: Review the ACL defined in the crypto map and verify that the destination is the management network.
ip access-list extended MGMT_TRAFFIC_ACL
 permit ip 10.1.34.0 0.0.0.255 10.22.2.0 0.0.0.255

Note: The management network is this example is 10.22.2.0/24

If management traffic is not transported between the managed network and the NOC via dedicated circuit, MPLS/VPN service, or IPsec tunnel, this is a finding.

Fix Text: This requirement is not applicable for the DODIN Backbone.

Ensure that a dedicated circuit, MPLS/VPN service, or IPsec tunnel is deployed to transport management traffic between the managed network and the NOC. If an IPsec tunnel is to be used, the steps below can be used as a guideline.

Step 1: Configure the ACL for the management network as the destination. This ACL will be defined in the crypto as the interesting traffic to be forwarded into the IPsec tunnel.

R4(config)#ip access-list extended MGMT_TRAFFIC_ACL
R4(config-ext-nacl)#permit ip 10.1.34.0 0.0.0.255 10.22.2.0 0.0.0.255
R4(config-ext-nacl)#exit

Step 2: Create an ISAKMP policy for Phase 1 negotiations.

R4(config)#crypto isakmp policy 10
R4(config-isakmp)#hash sha256
R4(config-isakmp)#authentication pre-share
R4(config-isakmp)#exit

Step 3: Specify the pre-shared key and the remote peer address.

R4(config)#crypto isakmp key 0 xxxxxx address x.1.12.1

Note: Digital certificates can be utilized as an alternative.

Step 4: Create the IPSec transform set for the data encryption

R4(config)#crypto ipsec transform-set TRANS_SET ah-sha256-hmac esp-aes
R4(cfg-crypto-trans)#mode tunnel
R4(cfg-crypto-trans)#exit

Step 5: Create the crypto map.

R4(config)#crypto map IPSEC_MGMT_MAP 10 ipsec-isakmp
R4(config-crypto-map)#set peer x.1.12.1
R4(config-crypto-map)#match address MGMT_TRAFFIC_ACL
R4(config-crypto-map)#set transform-set TRANS_SET
R4(config-crypto-map)#end

Step 6: Apply the crypto map to the external interface.

R4(config)#int g0/2
R4(config-if)#crypto map IPSEC_MGMT_MAP  

CCI: CCI-001097
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>588e8189-59ae-460e-9f3d-7ca3aff097b6</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000340 - Port Management</RuleName>
          <Comments>The Cisco perimeter router must be configured to filter egress traffic at the internal interface on an inbound direction.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
This requirement is not applicable for the DODIN Backbone.

Review the router configuration to verify that the egress ACL is bound to the internal interface in an inbound direction.

interface interface GigabitEthernet0/2
 description downstream link to LAN
 ip address 10.1.25.5 255.255.255.0
 ip access-group EGRESS_FILTER in

If the router is not configured to filter traffic leaving the network at the internal interface in an inbound direction, this is a finding.

Fix Text: This requirement is not applicable for the DODIN Backbone.

Configure the router to use an inbound ACL on all internal interfaces as shown in the example below.

R5(config)#int g0/2
R5(config-if)#ip access-group EGRESS_FILTER in  

CCI: CCI-001097
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>ip access-group EGRESS_FILTER in  </SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>ip mask-reply</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>d2ada4b1-2786-4d94-b9ff-ad75fd2ccfa4</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000180 - Port Management</RuleName>
          <Comments> The Cisco router must be configured to have Internet Control Message Protocol (ICMP) mask reply messages disabled on all external interfaces.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the router configuration and verify that ip mask-reply command is not enabled on any external interfaces as shown in the example below. 

interface GigabitEthernet0/1
 ip address x.x.x.x 255.255.255.0
 ip mask-reply

If the ip mask-reply command is configured on any external interface, this is a finding.

Fix Text: Disable ip mask-reply on all external interfaces as shown below.

R4(config)#int g0/1
R4(config-if)#no ip mask-reply  

CCI: CCI-002385
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart>^interface (TenGigabit|Gigabit|Fast|)Ethernet[\/0-9]+\r</ConfigBlockStart>
          <ConfigBlockEnd>!</ConfigBlockEnd>
          <ConfigBlockPatternType>Regex</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>no ip unreachables</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>b2a412a6-7363-4c79-a444-ea04943984ba</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000170 - Port Management</RuleName>
          <Comments>The Cisco router must be configured to have Internet Control Message Protocol (ICMP) unreachable messages disabled on all external interfaces.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the configuration to verify the no ip unreachables command has been configured on all external interfaces as shown in the configuration example below.

interface GigabitEthernet0/1
 ip address x.x.x.x 255.255.255.0
 no ip unreachables

If ICMP unreachable notifications are sent from any external or null0 interface, this is a finding.

Alternative – DODIN Backbone 

Verify that the PE router is configured to rate limit ICMP unreachable messages as shown in the example below.

ip icmp rate-limit unreachable 60000
ip icmp rate-limit unreachable DF 1000

Note: In the example above, packet-too-big message (ICMP Type 3 Code 4) can be sent once every second, while all other destination unreachable messages can be sent once every minute. This will avoid disrupting Path MTU Discovery for traffic traversing the backbone while mitigating the risk of an ICMP unreachable DoS attack.

If the PE router is not configured to rate limit ICMP unreachable messages, this is a finding.

Fix Text: Step 1: Disable ip unreachables on all external interfaces.

R4(config)#int g0/1
R4(config-if)#no ip unreachables

Step 2: Disable ip unreachables on the Null0 interface if it is used to backhole packets.

R4(config-if)#int null 0
R4(config-if)#no ip unreachables

Alternative – DODIN Backbone:

Configure the PE router to rate limit ICMP unreachable messages as shown in the example below:

R4(config)#ip icmp rate-limit unreachable df 100
R4(config)#ip icmp rate-limit unreachable 100000
R4(config)#end

Alternative – Non DODIN Backbone. 

An alternative for non-backbone networks (i.e. enclave, base, camp, etc.) is to filter messages generated by the router and silently drop ICMP Administratively Prohibited and Host Unreachable messages using the following configuration steps: 

Step 1: Configure ACL to include ICMP Type 3 Code 1 (Host Unreachable) and Code 13 (Administratively Prohibited) as shown in the example below:

R2(config)#ip access-list ext ICMP_T3C1C13
R2(config-ext-nacl)#permit icmp any any host-unreachable
R2(config-ext-nacl)#permit icmp any any administratively-prohibited
R2(config-ext-nacl)#exit

Step 2: Create a route map to forward these ICMP messages to the Null0 interface.

R2(config)#route-map LOCAL_POLICY
R2(config-route-map)#match ip address ICMP_T3C1C13
R2(config-route-map)#set interface Null0
R2(config-route-map)#exit

Step 3: Configure no ip unreachables on the Null0 interface.

R2(config)#int null 0
R2(config-if)#no ip unreachables
R2(config-if)#exit

Step 4: Apply the policy to filter messages generated by the router.

R2(config)#ip local policy route-map LOCAL_POLICY
R2(config)#end  

CCI: CCI-002385
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart>^interface (TenGigabit|Gigabit|Fast|)Ethernet[\/0-9]+\r</ConfigBlockStart>
          <ConfigBlockEnd>!</ConfigBlockEnd>
          <ConfigBlockPatternType>Regex</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
      </AssignedPolicyRules>
      <Grouping>CSCO-IOS-RTR</Grouping>
      <Comments />
      <PolicyName>CSCO-IOS-RTR - Port Management</PolicyName>
    </Policy>
  </AssignedPolicies>
  <ReportStatus>Enabled</ReportStatus>
</PolicyReport>