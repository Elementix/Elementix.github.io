<?xml version="1.0" encoding="utf-16"?>
<PolicyReport xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <ID>90f352ec-4ac4-471f-a782-b2b0020bac5e</ID>
  <Name>CSCO-IOS-RTR - Multicast</Name>
  <Comments>Cisco IOS Router RTR Security Technical Implementation Guide: Version: 1: Release: 2: 24 JAN 2020</Comments>
  <Group>Cisco-IOS-RTR-V1R1</Group>
  <ShowSummaryFlag>false</ShowSummaryFlag>
  <ShowRulesWithoutViolationFlag>true</ShowRulesWithoutViolationFlag>
  <AssignedPolicies>
    <Policy>
      <NodeSelectionString>WebCriteria:&lt;?xml version="1.0" encoding="utf-16"?&gt;
&lt;ArrayOfWebSelectionCriteria xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
  &lt;WebSelectionCriteria&gt;
    &lt;Id&gt;77c9a3f6-e818-4939-82bf-9b425864b4c9&lt;/Id&gt;
    &lt;LogicalCondition /&gt;
    &lt;SelectedColumn&gt;Vendor&lt;/SelectedColumn&gt;
    &lt;MatchType&gt;=&lt;/MatchType&gt;
    &lt;SelectedValue&gt;Cisco&lt;/SelectedValue&gt;
  &lt;/WebSelectionCriteria&gt;
&lt;/ArrayOfWebSelectionCriteria&gt;SQL:Where (Vendor = 'Cisco') </NodeSelectionString>
      <ConfigTypes>Any</ConfigTypes>
      <AssignedPolicyRules>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>46d2f4bc-63de-412e-bcae-110b27f1566e</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000880 - Multicast</RuleName>
          <Comments>The Cisco multicast Designated Router (DR) must be configured to limit the number of mroute states resulting from Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) Host Membership Reports</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the DR configuration to verify that it is limiting the number of mroute states via IGMP or MLD.

Verify IGMP limits have been configured globally or on each host-facing interface via the ip igmp limit command as shown in the example.

interface GigabitEthernet0/0
 ip address 10.3.3.3 255.255.255.0
…
 …
 …
ip igmp limit nn

If the DR is not limiting multicast join requests via IGMP or MLD on a global or interfaces basis, this is a finding.

Fix Text: Configure the DR on a global or interface basis to limit the number of mroute states resulting from IGMP or MLD membership reports.

R3(config)#int g0/0
R3(config-if)#ip igmp limit 2  

CCI: CCI-002385
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>ip igmp limit nn</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>ip pim sparse-mode</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>ip igmp access-group IGMP_JOIN_FILTER</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>ip igmp version 3</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>d5243e1e-44b4-41c6-a593-49c146e25e0b</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000870 - Multicast</RuleName>
          <Comments>The Cisco multicast Designated Router (DR) must be configured to filter the Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) Report messages to allow hosts to join a multicast group only from sources that have been approved by the organization.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the configuration of the DR to verify that it is filtering IGMP or MLD report messages, allowing hosts to only join multicast groups from sources that have been approved.

Step 1: Verify that all host-facing interfaces are configured to filter IGMP Membership Report messages (IGMP joins) as shown in the example below.

interface GigabitEthernet0/0
 ip address 10.3.3.3 255.255.255.0
 ip pim sparse-mode
 ip igmp access-group IGMP_JOIN_FILTER
 ip igmp version 3

Step 2: Verify that the Access Control List (ACL) denies unauthorized sources or allows only authorized sources. The example below denies all groups from 232.8.0.0/16 range and permits sources only from the x.0.0.0/8 network.

ip access-list extended IGMP_JOIN_FILTER
 deny ip any 232.8.0.0 0.0.255.255
 permit ip x.0.0.0 0.255.255.255 any
 deny ip any any

Note: This requirement is only applicable to Source Specific Multicast (SSM) implementation.

If the DR is not filtering IGMP or MLD report messages, this is a finding.

Fix Text: Configure the DR to filter the IGMP and MLD report messages to allow hosts to join only those multicast groups from sources that have been approved as shown in the example.

R3(config)#ip access-list extended IGMP_JOIN_FILTER
R3(config-ext-nacl)#deny ip any 232.8.0.0 0.0.255.255
R3(config-ext-nacl)#permit ip x.0.0.0 0.255.255.255 any
R3(config-ext-nacl)#deny ip any any
R3(config-ext-nacl)#exit

Step 2: Apply the filter to all host facing interfaces.

R3(config)#int g0/0
R3(config-if)#ip igmp access-group IGMP_JOIN_FILTER  

CCI: CCI-002403
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>491ba81c-4256-44bb-a4ef-7706ee9b784e</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000810 - Multicast</RuleName>
          <Comments>The Cisco multicast edge router must be configured to establish boundaries for administratively scoped multicast traffic.
</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the router configuration and verify that admin-scope multicast traffic is blocked at the external edge as shown in the example below.

interface GigabitEthernet1/2
 ip address x.1.12.2 255.255.255.252
 ip pim sparse-mode
 ip multicast boundary MULTICAST_SCOPE
…
…
…
ip access-list standard MULTICAST_SCOPE
 deny 239.0.0.0 0.255.255.255
 permit any

If the router is not configured to establish boundaries for administratively scoped multicast traffic, this is a finding.

Fix Text: Step 1: Configure the ACL to deny packets with multicast administratively scoped destination addresses as shown in the example below.

R2(config)#ip access-list standard MULTICAST_SCOPE
R2(config-std-nacl)#deny 239.0.0.0 0.255.255.255
R2(config-std-nacl)#permit any
R2(config-std-nacl)#exit

Step 2: Apply the multicast boundary at the appropriate interfaces as shown in the example below.

R2(config)#int g1/2
R2(config-if)#ip multicast boundary MULTICAST_SCOPE
R2(config-if)#end  

CCI: CCI-001414
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText>ip multicast boundary MULTICAST_SCOPE</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>8e98009a-a5e8-4cb5-a98d-8c8f705d6f63</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000800 - Multicast</RuleName>
          <Comments>The Cisco multicast router must be configured to bind a Protocol Independent Multicast (PIM) neighbor filter to interfaces that have PIM enabled.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
This requirement is not applicable for the DODIN Backbone.

Step 1: Verify all interfaces enabled for PIM have a neighbor ACL bound to the interface as shown in the example below.

interface GigabitEthernet1/1
 ip address 10.1.2.2 255.255.255.0
 ip pim neighbor-filter PIM_NEIGHBORS
 ip pim sparse-mode

Step 2: Review the configured ACL for filtering PIM neighbors as shown in the example below.

ip access-list standard PIM_NEIGHBORS
 permit 10.1.2.6

If PIM neighbor ACLs are not bound to all interfaces that have PIM enabled, this is a finding.

Fix Text: This requirement is not applicable for the DODIN Backbone.

Configure neighbor ACLs to only accept PIM control plane traffic from documented PIM neighbors. Bind neighbor ACLs to all PIM enabled interfaces.

Step 1: Configure ACL for PIM neighbors

R2(config)#ip access-list standard PIM_NEIGHBORS
R2(config-std-nacl)#permit 10.1.2.6
R2(config-std-nacl)#exit

Step 2: Apply the ACL to all interfaces enabled for PIM

R2(config)#int g1/1
R2(config-if)#ip pim neighbor-filter PIM_NEIGHBORS  

CCI: CCI-001414
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>ip pim neighbor-filter PIM_NEIGHBORS</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition />
              <Pattern>ip pim accept-register list PIM_REGISTER_FILTER</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Like</PatternType>
              <Condition>AND</Condition>
              <Pattern>ip pim register-rate-limit nn</Pattern>
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>e3db461b-93da-4b53-bcf8-9f508c58b4a4</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000820 - Mulitcast</RuleName>
          <Comments>The Cisco multicast Rendezvous Point (RP) router must be configured to limit the multicast forwarding cache so that its resources are not saturated by managing an overwhelming number of Protocol Independent Multicast (PIM) and Multicast Source Discovery Protocol (MSDP) source-active entries.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
The Cisco router does not have a mechanism to limit the multicast forwarding cache. However, the risk associated with this requirement can be fully mitigated by configuring the router to:

1. Filter PIM register messages.
2. Rate limiting the number of PIM register messages.
3. Accept MSDP packets only from known MSDP peers.

Step 1: Verify that the RP router is configured to filter PIM register messages for any undesirable multicast groups and sources. The example below will deny any multicast streams for groups 239.5.0.0/16 and allow from only sources 10.1.2.6 and 10.1.2.7. 

ip pim rp-address 10.1.12.3
ip pim accept-register list PIM_REGISTER_FILTER
…
…
…
ip access-list extended PIM_REGISTER_FILTER
 deny ip any 239.5.0.0 0.0.255.255
 permit ip host 10.1.2.6 any
 permit ip host 10.1.2.7 any
 deny ip any any

Step 2: Verify that the router is configured to rate limiting the number of PIM register messages as shown in the example below.

ip pim rp-address 10.2.2.2
ip pim register-rate-limit nn

Step 3: Review the router configuration to determine if there is a receive path or interface filter to only accept MSDP packets from known MSDP peers as shown in the example below.

Step 3a: Verify that interfaces used for MSDP peering have an inbound ACL as shown in the example.

interface GigabitEthernet1/1
 ip address x.1.28.8 255.255.255.0
 ip access-group EXTERNAL_ACL_INBOUND in
 ip pim sparse-mode

Step 3b: Verify that the ACL restricts MSDP peering to only known sources.

ip access-list extended EXTERNAL_ACL_INBOUND
 permit tcp any any established
 permit tcp host x.1.28.2 host x.1.28.8 eq 639
 deny tcp any host x.1.28.8 eq 639 log
 permit tcp host x.1.28.2 host 10.1.28.8 eq bgp
 permit tcp host x.1.28.2 eq bgp host x.1.28.8
 permit pim host x.1.28.2 pim host x.1.28.8
…
 …
 …
deny ip any any log

Note: MSDP connections is via TCP port 639

If the RP router is not configured to filter PIM register messages, rate limiting the number of PIM register messages, and accept MSDP packets only from known MSDP peers, this is a finding.

Fix Text: The risk associated with this requirement can be fully mitigated by configuring the router to filter PIM register messages, rate limiting the number of PIM register messages, and accept MSDP packets only from known MSDP peers.

Step 1: Configure the router to filter PIM register messages received from a multicast DR for any undesirable multicast groups and sources. The example below will deny any multicast streams for groups 239.5.0.0/16 and allow from only sources 10.1.2.6 and 10.1.2.7. 

R2(config)#ip access-list extended PIM_REGISTER_FILTER
R2(config-ext-nacl)#deny ip any 239.5.0.0 0.0.255.255
R2(config-ext-nacl)#permit ip host 10.1.2.6 any
R2(config-ext-nacl)#permit ip host 10.1.2.7 any
R2(config-ext-nacl)#deny ip any any
R2(config-ext-nacl)#exit
R2(config)#ip pim accept-register list PIM_REGISTER_FILTER
R2(config)#end 

Step 2: Configure the RP to rate limit the number of multicast register messages.

R2(config)#ip pim register-rate-limit nn

Step 3: Configure the receive path or interface ACLs to only accept MSDP packets from known MSDP peers.

R8(config)#ip access-list extended EXTERNAL_ACL_INBOUND
R8(config-ext-nacl)#permit tcp any any established
R8(config-ext-nacl)#permit tcp host x.1.28.2 host x.1.28.8 eq 639
R8(config-ext-nacl)#deny tcp any host x1.28.8 eq 639
R8(config-ext-nacl)#permit tcp host x.1.28.2 host x.1.28.8 eq bgp
R8(config-ext-nacl)#permit tcp host x.1.28.2 eq bgp host x.1.28.8
R8(config-ext-nacl)#permit pim host x.1.28.2 host x.1.28.8
…
…
…
R8(config-ext-nacl)#deny ip any any  

CCI: CCI-002385
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>true</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText />
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>2caf89cd-d278-4865-82ac-a515a5a4a95d</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000840 - Multicast</RuleName>
          <Comments>The Cisco multicast Rendezvous Point (RP) router must be configured to filter Protocol Independent Multicast (PIM) Join messages received from the Designated Router (DR) for any undesirable multicast groups.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Verify that the RP router is configured to filter PIM join messages for any undesirable multicast groups. In the example below, groups from 239.8.0.0/16 are not allowed.

ip pim rp-address 10.2.2.2
ip pim accept-rp 10.2.2.2 FILTER_PIM_JOINS
…
…
…
ip access-list standard FILTER_PIM_JOINS
 deny 239.8.0.0 0.0.255.255
 permit any
!

If the RP is not configured to filter join messages received from the DR for any undesirable multicast groups, this is a finding.

Fix Text: Configure the RP to filter PIM join messages for any undesirable multicast groups as shown in the example below.

R2(config)#ip access-list standard PIM_JOIN_FILTER
R2(config-std-nacl)#deny 239.8.0.0 0.0.255.255
R2(config-std-nacl)#permit any
R2(config-std-nacl)#exit
R2(config)#ip pim accept-rp 10.2.2.2 PIM_JOIN_FILTER 
R2(config)#end  

CCI: CCI-001414
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText>ip pim accept-rp 10.2.2.2 FILTER_PIM_JOINS</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>967bbba7-7acb-45ec-a1d3-a58caa56682d</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000830 - Multicast</RuleName>
          <Comments>The Cisco multicast Rendezvous Point (RP) router must be configured to filter Protocol Independent Multicast (PIM) Register messages received from the Designated Router (DR) for any undesirable multicast groups and sources.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Verify that the RP router is configured to filter PIM register messages. The example below will deny any multicast streams for groups 239.5.0.0/16 and allow from only sources 10.1.2.6 and 10.1.2.7. 

ip pim rp-address 10.1.12.3
ip pim accept-register list PIM_REGISTER_FILTER
…
…
…
ip access-list extended PIM_REGISTER_FILTER
 deny ip any 239.5.0.0 0.0.255.255
 permit ip host 10.1.2.6 any
 permit ip host 10.1.2.7 any
 deny ip any any

If the RP router peering with PIM-SM routers is not configured with a policy to block registration messages for any undesirable multicast groups and sources, this is a finding.

Fix Text: Configure the router to filter PIM register messages received from a multicast DR for any undesirable multicast groups and sources. The example below will deny any multicast streams for groups 239.5.0.0/16 and allow from only sources 10.1.2.6 and 10.1.2.7. 

R2(config)#ip access-list extended PIM_REGISTER_FILTER
R2(config-ext-nacl)#deny ip any 239.5.0.0 0.0.255.255
R2(config-ext-nacl)#permit ip host 10.1.2.6 any
R2(config-ext-nacl)#permit ip host 10.1.2.7 any
R2(config-ext-nacl)#deny ip any any
R2(config-ext-nacl)#exit
R2(config)#ip pim accept-register list PIM_REGISTER_FILTER
R2(config)#end  

CCI: CCI-001414
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText>ip pim accept-register list PIM_REGISTER_FILTER</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>1060c391-522b-4362-bcc8-c04a5c17c414</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000860 - Multicast</RuleName>
          <Comments>The Cisco multicast Designated Router (DR) must be configured to filter the Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) Report messages to allow hosts to join only multicast groups that have been approved by the organization.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the configuration of the DR to verify that it is filtering IGMP or MLD Membership Report messages, allowing hosts to join only those groups that have been approved.

Step 1: Verify that all host facing interfaces are configured to filter IGMP Membership Report messages (IGMP joins) as shown in the example below.

interface GigabitEthernet0/0
 ip address 10.3.3.3 255.255.255.0
 ip pim sparse-mode
 ip igmp access-group IGMP_JOIN_FILTER
 ip igmp version 3

Step 2: Verify that the Access Control List (ACL) denies unauthorized groups or permits only authorized groups. The example below denies all groups from 239.8.0.0/16 range.

ip access-list standard IGMP_JOIN_FILTER
 deny 239.8.0.0 0.0.255.255
 permit any

Note: This requirement is only applicable to Source Specific Multicast (SSM) implementation. This requirement is not applicable to Any Source Multicast (ASM) since the filtering is being performed by the Rendezvous Point router.

If the DR is not filtering IGMP or MLD Membership Report messages, this is a finding.

Fix Text: Configure the DR to filter the IGMP or MLD Membership Report messages to allow hosts to join only those multicast groups that have been approved.

Step 1: Configure the ACL to filter IGMP Membership Report messages as shown in the example.

R3(config)#ip access-list standard IGMP_JOIN_FILTER
R3(config-std-nacl)#deny 239.8.0.0 0.0.255.255
R3(config-std-nacl)#permit any
R3(config-std-nacl)#exit

Step 2: Apply the filter to all host facing interfaces.

R3(config)#int g0/0
R3(config-if)#ip igmp access-group IGMP_JOIN_FILTER  

CCI: CCI-002403
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>0</ErrorLevel>
          <SimplePatternText>ip igmp access-group IGMP_JOIN_FILTER  </SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>9ad83e0d-6a1d-458a-9e44-c52a2815333c</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000850 - Multicast</RuleName>
          <Comments>The Cisco multicast Rendezvous Point (RP) must be configured to rate limit the number of Protocol Independent Multicast (PIM) Register messages.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the configuration of the RP to verify that it is rate limiting the number of PIM register messages.

ip pim rp-address 10.2.2.2
ip pim register-rate-limit nn

If the RP is not limiting PIM register messages, this is a finding.

Fix Text: Configure the RP to rate limit the number of multicast register messages.

R2(config)#ip pim register-rate-limit nn  

CCI: CCI-002385
_____________________________________________________________</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>ip pim register-rate-limit nn</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>f2a9f338-e13d-49ea-b39d-d44f65175ea0</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000790 - Multicast</RuleName>
          <Comments>The Cisco multicast router must be configured to disable Protocol Independent Multicast (PIM) on all interfaces that are not required to support multicast routing.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Step 1: Review the network's multicast topology diagram.

Step 2: Review the router configuration to verify that only the PIM interfaces as shown in the multicast topology diagram are enabled for PIM as shown in the example below.

interface GigabitEthernet1/1
 ip address 10.1.3.3 255.255.255.0
 ip pim sparse-mode

If an interface is not required to support multicast routing and it is enabled, this is a finding.

Fix Text: Document all enabled interfaces for PIM in the network's multicast topology diagram. Disable support for PIM on interfaces that are not required to support it.

R5(config)#int g1/1
R5(config-if)#no ip pim sparse-mode  

CCI: CCI-001414
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>ip pim sparse-mode</SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
        <PolicyRule>
          <MultiLineRulePatterns>
            <MultiLineRulePattern>
              <EndBracket />
              <PatternType>Regex</PatternType>
              <Condition />
              <Pattern />
              <Criteria>true</Criteria>
              <BeginBracket />
            </MultiLineRulePattern>
          </MultiLineRulePatterns>
          <RuleId>5ae84f49-204f-49cb-bbe9-d71c46c6201d</RuleId>
          <RuleName>CSCO-IOS-RTR-CISC-RT-000890 - Multicast</RuleName>
          <Comments>The Cisco multicast Designated Router (DR) must be configured to set the shortest-path tree (SPT) threshold to infinity to minimalize source-group (S, G) state within the multicast topology where Any Source Multicast (ASM) is deployed.</Comments>
          <Grouping>CSCO-IOS-RTR</Grouping>
          <RemediateScript>Check Content:  
Review the DR configuration to verify that the SPT switchover threshold is increased (default is "0") or set to infinity (never switch over). 

ip pim rp-address 10.2.2.2
ip pim spt-threshold infinity

If the DR is not configured to increase the SPT threshold or set to infinity to minimalize (S, G) state, this is a finding.

Fix Text: Configure the DR to increase the SPT threshold or set it to infinity to minimalize (S, G) state within the multicast topology where ASM is deployed.

R3(config)#ip pim spt-threshold infinity  

CCI: CCI-002385
_____________________________________________________________
</RemediateScript>
          <ConfigBlockStart />
          <ConfigBlockEnd />
          <ConfigBlockPatternType>Like</ConfigBlockPatternType>
          <ConfigBlockMustExist>false</ConfigBlockMustExist>
          <PatternType>Like</PatternType>
          <PatternMustExist>true</PatternMustExist>
          <AdvancedMode>false</AdvancedMode>
          <ErrorLevel>1</ErrorLevel>
          <SimplePatternText>ip pim spt-threshold infinity  </SimplePatternText>
          <ExecuteScriptAutomatically>false</ExecuteScriptAutomatically>
          <Owner>admin</Owner>
          <RemediateScriptType>CLI</RemediateScriptType>
          <ExecuteRemediationScriptPerBlock>false</ExecuteRemediationScriptPerBlock>
          <ExecuteScriptInConfigMode>false</ExecuteScriptInConfigMode>
        </PolicyRule>
      </AssignedPolicyRules>
      <Grouping>CSCO-IOS-RTR</Grouping>
      <Comments />
      <PolicyName>CSCO-IOS-RTR - Mulitcast</PolicyName>
    </Policy>
  </AssignedPolicies>
  <ReportStatus>Enabled</ReportStatus>
</PolicyReport>